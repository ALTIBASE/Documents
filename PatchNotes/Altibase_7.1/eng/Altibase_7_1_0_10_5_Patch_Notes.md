# Altibase 7.1.0.10.5 Patch Notes

<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->

- [New Features](#new-features)
    - [BUG-51532 Parallel execution functionality added to the iLoader script generated by aexport](#bug-51532)
    - [BUG-51652 Login should be possible with an encrypted password file instead of entering the user password](#bug-51652)
    - [BUG-51698 Support for Encrypting PASSWORD in dblink, AKU, and Adapter Configuration Files Using altiEncrypt](#bug-51698)
    - [BUG-51538 Memory optimization for count(*) on Fixed Table](#bug-51538)
- [Fixed Bugs](#fixed-bugs)
    - [BUG-50945 [ERR-01003 : Unexpected end of string] error occurs when EMPTY_CLOB() is used as an argument in the SUBSTR function](#bug-50945)
    - [BUG-50946 Incorrect results are returned when the starting value is negative for SUBSTR, SUBSTRB function calls on a CLOB column](#bug-50946)
    - [BUG-50992 Offline adapter fails to synchronize data if the adapter is stopped by a DDL operation.](#bug-50992)
    - [BUG-51029 Fixed an operation error for AFTER UPDATE trigger on an empty LOB column](#bug-51029)
    - [BUG-51131 Fixed an issue where the `EEEE` output format in the TO_CHAR function was not applied to certain NUMERIC data](#bug-51131)
    - [BUG-51323 Fixed an error that occurs when a view used in a subquery in the SET clause of an UPDATE statement is referenced in another subquery in the WHERE clause](#bug-51323)
    - [BUG-51347 The server may abnormally terminate when executing a multiple update statement on a nested view](#bug-51347)
    - [BUG-51419 Changed the DDL statement generation order for synonym and directory objects generated by aexport to alphabetical order](#bug-51419)
    - [BUG-51457 An incorrect error is displayed when the path specified by MEM_DB_DIR does not exist](#bug-51457)
    - [BUG-51480 Modified to prevent write (w) permission from being granted to other users for files created by `altibase`](#bug-51480)
    - [BUG-51491 Fixed an issue where the server could abnormally terminate due to a logic error in checking if a table is a Temporary table](#bug-51491)
    - [BUG-51519 Fixed an issue where the server abnormally terminated in specific cases when using the third argument of the Lead function.](#bug-51519)
    - [BUG-51525 Exception occurs when executeUpdate is performed after executeBatch](#bug-51525)
    - [BUG-51543 Low probability of [ERR-11069 : Internal server error in the storage manager (fail to insert key)] error in disk index](#bug-51543)
    - [BUG-51630 An error occurs when DDL is executed on a table that has inter-referencing relationships with tables, views, and functions](#bug-51630)
    - [BUG-51707 In a multi-replication environment, an error occurs while reading the LOB log in one replication if another replication has a disk table that includes a LOB](#bug-51707)
    - [BUG-51766 Added config.xml.sample for altiMon configuration file](#bug-51766)
    - [BUG-51790 Changed the MAX LOOP value that determines if the connection between leaf nodes is broken during memory index traversal](#bug-51790)
    - [BUG-51804 Fixed an issue where unexpected behavior could occur if the server is forcefully terminated after creating a memory table containing a VARIABLE column (before the FLUSH stage)](#bug-51804)
- [Changes](#changes)
    - [Version Info](#version-info)
    - [Compatibility](#compatibility)
    - [Altibase Server Properties](#altibase-server-properties)
    - [Performance Views](#performance-views)

<!-- END doctoc generated TOC please keep comment here to allow auto update -->

New Features
============

### BUG-51532<a name=bug-51532></a> Parallel execution functionality added to the iLoader script generated by aexport

- **module**: ux-aexport
- **Category**: Enhancement
- **Description**: Added support for parallel execution of iloader scripts generated by aexport.

-   **How to reproduce this bug**

    -   **Reproduction conditions**

    -   **Actual Results**

    -   **Expected Results**

-   **Workaround**

-   **Changes**
    -   Performance view
    -   Property
    -   Compile Option
    -   Error Code

### BUG-51652<a name=bug-51652></a> Login should be possible with an encrypted password file instead of entering the user password

- **module**: ux-isql
- **Category**: Functionality
- **Description**: iSQL can now save the user password to an encrypted file, and this file can be used for login in iSQL, aexport, and iLoader via the **`-pf` option**.

-   **How to reproduce this bug**

    -   **Reproduction conditions**

    -   **Actual Results**

    -   **Expected Results**

-   **Workaround**

-   **Changes**

    -   Performance view
    -   Property
    -   Compile Option
    -   Error Code

### BUG-51698<a name=bug-51698></a> Support for Encrypting PASSWORD in dblink, AKU, and Adapter Configuration Files Using altiEncrypt

- **module**: rp
- **Category**: Functionality
- **Description**: The password encryption tool **`altiEncrypt`** has been added.
   Using `altiEncrypt`, user can now encrypt the `PASSWORD` values in the **dblink**, **AKU**, and **Adapter** configuration (conf) files and set them securely.

-   **How to reproduce this bug**
    -   **Reproduction conditions**
    
    -   **Actual Results**
    
    -   **Expected Results**
    
-   **Workaround**

-   **Changes**
    -   Performance view
    -   Property
    -   Compile Option
    -   Error Code

### BUG-51538<a name=bug-51538></a> Memory optimization for count(*) on Fixed Table

- **module**: qp-select-execute
- **Category**: Enhancement
- **Description**: Optimized memory usage for count(*) on Fixted Table.

-   **How to reproduce this bug**

    -   **Reproduction conditions**

    -   **Actual Results**

    -   **Expected Results**

-   **Workaround**

-   **Changes**

    -   Performance view
    -   Property
    -   Compile Option
    -   Error Code

Fixed Bugs
==========

### BUG-50945<a name=bug-50945></a> [ERR-01003 : Unexpected end of string] error occurs when EMPTY_CLOB() is used as an argument in the SUBSTR function

- **module**: mt-function
- **Category**: Functional Error
- **Description**: Fixed the `[ERR-01003 : Unexpected end of string]` error that occurred when `EMPTY_CLOB()` was used as an argument within the `SUBSTR` function.

- **How to reproduce this bug**

  - **Reproduction conditions**

    ```sql
    SELECT SUBSTR( EMPTY_CLOB(), 1, 1 ) FROM dual;
    ```

  - **Actual Results**

    ```sql
    [ERR-01003 : Unexpected end of string]
    ```

  -   **Expected Results**

      ```sql
      iSQL> SELECT SUBSTR( EMPTY_CLOB(), 1, 1 ) FROM dual;
      SUBSTRB(EMPTY_CLOB(),1,1)
      -----------------------------
      1 row selected.
      ```

-   **Workaround**

-   **Changes**

    -   Performance view
    -   Property
    -   Compile Option
    -   Error Code

### BUG-50946<a name=bug-50946></a> Incorrect results are returned when the starting value is negative for SUBSTR, SUBSTRB function calls on a CLOB column

- **module**: mt-function
- **Category**: Functional Error
- **Description**: Fixed an issue where incorrect results were returned when the starting value was negative for `SUBSTR` or `SUBSTRB` function calls on a CLOB column.

- **How to reproduce this bug**

  - **Reproduction conditions**

    ```sql
    DROP TABLE t1;
    CREATE TABLE t1(c1 CLOB);
    INSERT INTO t1 VALUES ('CLOB');
    SELECT SUBSTR(c1, -1, 1) FROM t1;
    SELECT SUBSTRB(c1, -1, 1) FROM t1;
    ```

  - **Actual Results**

    ```sql
    iSQL> SELECT SUBSTR(c1, -1, 1) FROM t1;
    SUBSTR(C1, -1, 1) :
    
    1 row selected.
    iSQL> SELECT SUBSTRB(c1, -1, 1) FROM t1;
    SUBSTRB(C1, -1, 1) :
    
    1 row selected.
    ```

  -   **Expected Results**

      ```sql
      iSQL> SELECT SUBSTR(c1, -1, 1) FROM t1;
      SUBSTR(C1,-1,1) : B
      
      1 row selected.
      iSQL> SELECT SUBSTRB(c1, -1, 1) FROM t1;
      SUBSTRB(C1,-1,1) : B
      
      1 row selected.
      ```

-   **Workaround**

-   **Changes**

    -   Performance view
    -   Property
    -   Compile Option
    -   Error Code

### BUG-50992<a name=bug-50992></a> Offline adapter fails to synchronize data after the adapter is stopped by a DDL operation.

- **module**: rp

- **Category**: Functional Error

- **Description**: Fixed an issue where data synchronization failed when the offline adapter was executed immediately after the adapter was terminated by a DDL operation.

- **How to reproduce this bug**

  - **Reproduction conditions**

    ```
    1.Create an adapter with Meta Logging enabled and start it
    2.Perform DDL on the replication table
    3.Stop replication
    4.Perform offline adapter on the standby
    ```

  - **Actual Results**

        Data synchronization failed


  - **Expected Results**

        Data synchronization has been completed.

-   **Workaround**

-   **Changes**
    -   Performance view
    -   Property
    -   Compile Option
    -   Error Code

### BUG-51029<a name=bug-51029></a> Fixed an operation error for AFTER UPDATE trigger on an empty LOB column

- **module**: qp-psm-trigger-execute
- **Category**: Functional Error
- **Description**: Fixed an issue where an error occurred when performing DML on a LOB column with size 0 (like `empty_CLOB()`) during an `AFTER UPDATE` trigger operation.

- **How to reproduce this bug**

  - **Reproduction conditions**

    ```sql
    DROP TABLE t1;
    DROP TABLE t2;
    CREATE TABLE t1 ( i1 clob, i2 CLOB ) TABLESPACE sys_tbs_disk_data;
    CREATE TABLE t2 ( i1 clob, i2 CLOB );
    INSERT INTO t1 VALUES( '1', empty_CLOB() );
    CREATE TRIGGER trig1
    AFTER UPDATE ON t1
    REFERENCING
      OLD AS OLDROW,
      NEW AS NEWROW
    FOR EACH ROW
    AS
    BEGIN
      INSERT INTO t2 VALUES ( newrow.i1, newrow.i2 );
    END;
    /
    UPDATE t1 SET i1 = i1 || 'a';
    ```

  -   **Actual Results**

          [ERR-110D0 : The lob size is bigger than the maximum lob size]

  -   **Expected Results**

          1 row updated

-   **Workaround**

-   **Changes**

    -   Performance view
    -   Property
    -   Compile Option
    -   Error Code

### BUG-51131<a name=bug-51131></a> Fixed an issue where the `EEEE` output format in the TO_CHAR function was not applied to certain NUMERIC data

- **module**: mt-function
- **Category**: Functional Error
- **Description**: Fixed an issue where the `EEEE` output format in the `TO_CHAR` function was not applied to certain `NUMERIC` data.

-   **How to reproduce this bug**

    -   **Reproduction conditions**

    -   **Actual Results**

    -   **Expected Results**

-   **Workaround**

-   **Changes**

    -   Performance view
    -   Property
    -   Compile Option
    -   Error Code

### BUG-51323<a name=bug-51323></a> Fixed an error that occurs when a view used in a subquery in the SET clause of an UPDATE statement is referenced in another subquery in the WHERE clause

- **module**: qp
- **Category**: Functional Error
- **Description**: Fixed an error that occurs when a view used in a subquery in the `SET` clause of an `UPDATE` statement is referenced in another subquery in the `WHERE` clause.

- **How to reproduce this bug**

  - **Reproduction conditions**

    ```sql
    DROP VIEW v1;
    DROP TABLE t1 CASCADE;
    
    CREATE VIEW v1 AS SELECT 1 AS X FROM DUAL LIMIT 1;
    CREATE TABLE t1 ( i1 integer );
    UPDATE t1 SET i1=(SELECT 2 FROM v1) WHERE i1 IN (SELECT 3 FROM v1);
    ```

  - **Actual Results**

    ```
    [ERR-31455 : Failed to work because an internal exception occurred from an OS.[Contact Altibase's Support Center]]
    ```

  - **Expected Results**

    ```
    No rows updated.
    ```

-   **Workaround**

-   **Changes**

    -   Performance view
    -   Property
    -   Compile Option
    -   Error Code

### BUG-51347<a name=bug-51347></a> The server may abnormally terminate when executing a multiple update statement on a nested view

- **module**: qp
- **Category**: Functional Error
- **Description**: Fixed an issue where the server abnormally terminated when a multiple update statement was executed on a nested view created based on a partitioned table.

-   **How to reproduce this bug**

    -   **Reproduction conditions**

    -   **Actual Results**

    -   **Expected Results**

-   **Workaround**

-   **Changes**

    -   Performance view
    -   Property
    -   Compile Option
    -   Error Code

### BUG-51419<a name=bug-51419></a> Changed the DDL statement generation order for synonym and directory objects generated by aexport to alphabetical order

- **module**: ux-aexport
- **Category**: Usability
- **Description**: Changed the DDL statement generation order for synonym and directory objects created by aexport to alphabetical order.

-   **How to reproduce this bug**

    -   **Reproduction conditions**

    -   **Actual Results**

    -   **Expected Results**
-   **Workaround**
-   **Changes**

    -   Performance view
    -   Property
    -   Compile Option
    -   Error Code

### BUG-51457<a name=bug-51457></a> An incorrect error is displayed when the path specified by MEM_DB_DIR does not exist

- **module**: sm
- **Category**: Enhancement
- **Description**: Fixed an issue where an incorrect error message was displayed when the path specified by `MEM_DB_DIR` did not exist.

-   **How to reproduce this bug**

    -   **Reproduction conditions**

    -   **Actual Results**

    -   **Expected Results**

-   **Workaround**

-   **Changes**

    -   Performance view
    -   Property
    -   Compile Option
    -   Error Code

### BUG-51480<a name=bug-51480></a> Modified to prevent write (w) permission from being granted to other users for files created by `altibase`

- **module**: id
- **Category**: Security
- **Description**: Modified to prevent write (`w`) permission from being granted to other users for files created by `altibase`.

-   **How to reproduce this bug**

    -   **Reproduction conditions**

    -   **Actual Results**

    -   **Expected Results**

-   **Workaround**

-   **Changes**
    -   Performance view
    -   Property
    -   Compile Option
    -   Error Code

### BUG-51491<a name=bug-51491></a> Fixed an issue where the server could abnormally terminate due to a logic error in checking if a table is a Temporary table

- **module**: qp
- **Category**: Fatal
- **Description**: Fixed an issue where the server could abnormally terminate due to a logic error in checking if a table is a Temporary table.

-   **How to reproduce this bug**

    -   **Reproduction conditions**

    -   **Actual Results**

    -   **Expected Results**

-   **Workaround**

-   **Changes**

    -   Performance view
    -   Property
    -   Compile Option
    -   Error Code

### BUG-51519<a name=bug-51519></a> Fixed an issue where the server abnormally terminated in specific cases when using the third argument of the Lead function.

- **module**: qp-select-execute
- **Category**: Fatal
- **Description**: Fixed an issue where the server abnormally terminated in specific cases when using the third argument of the Lead function.

- **How to reproduce this bug**

  -   **Reproduction conditions**

      ```sql
      DROP TABLE t1;
      CREATE TABLE t1 ( i1 int , i2 int , i3 int);
      INSERT into t1 values ( 1, 49106157, 1);
      
      DROP TABLE t2;
      create table t2 ( i1 int, i2 int, i3 int, i4 int);
      select i1, change, i2 from (
      select lead( buy - sell, 1, 0) over ( partition by i2 order by i1  ) as change, i2, i1
      from
      (
      select nvl( case when i3 = 1 then i2
                       when i3 = 2 then i2
                       when i3 = 3 then i2
                       else 0 end, 0) as buy, numeric'0' as sell, i1, i2
      from t1
      union all
      select nvl( case when i3 = 1 then i2
                       when i3 = 2 then i2
                       when i3 = 3 then i2
                       else 0 end, 0) as sell, numeric'0' as buy, i1, i2
      from t2
      ) order by i1 desc, i2 desc
      );
      ```
      
  -   **Actual Results**

          [ERR-91015 : Communication failure.]

  -   **Expected Results**

      ```sql
      I1          CHANGE      I2
      ----------------------------------------
      1           0           49106157
      1 row selected.
      ```

- **Workaround**

  ```sql
  --Use the `NVL` function instead of the 3rd argument
  select i1, change, i2 from (
  select nvl(lead( buy - sell, 1) over ( partition by i2 order by i1  ), 0) as change, i2, i1
  from
  (
  select nvl( case when i3 = 1 then i2
                   when i3 = 2 then i2
                   when i3 = 3 then i2
                   else 0 end, 0) as buy, numeric'0' as sell, i1, i2
  from t1
  union all
  select nvl( case when i3 = 1 then i2
                   when i3 = 2 then i2
                   when i3 = 3 then i2
                   else 0 end, 0) as sell, numeric'0' as buy, i1, i2
  from t2
  ) order by i1 desc, i2 desc
  );
  ```

-   **Changes**

    -   Performance view
    -   Property
    -   Compile Option
    -   Error Code

### BUG-51525<a name=bug-51525></a> Exception occurs when executeUpdate is performed after executeBatch

- **module**: mm-jdbc
- **Category**: Other
- **Description**: Fixed an issue where an exception occurred when `ExecuteBatch()` and `ExecuteUpdate()` were executed sequentially on a table containing a CLOB column.
  - Reproduction conditions
    1. Must be executed using a single PreparedStatement.
    2. The table must contain a LOB column.

-   **How to reproduce this bug**
  -   **Reproduction conditions**

  -   **Actual Results**

  -   **Expected Results**

-   **Workaround**

-   **Changes**

  -   Performance view
  -   Property
  -   Compile Option
  -   Error Code

### BUG-51543<a name=bug-51543></a> Low probability of [ERR-11069 : Internal server error in the storage manager (fail to insert key)] error in disk index

- **module**: sm
- **Category**: Fatal
- **Description**: Fixed an issue where the `[ERR-11069 : Internal server error in the storage manager (fail to insert key)]` error occurred with a low probability in the disk index.

- **How to reproduce this bug**

  - **Reproduction conditions**

    ```sql
    CREATE TABLE T1 ( I1 CHAR(1500), I2 CHAR(1500), I3 INT ) TABLESPACE SYS_TBS_DISK_DATA;
    CREATE INDEX IDX1 ON T1 ( I2, I1 );
    INSERT INTO T1 VALUES ( 2, 2, 221 );
    INSERT INTO T1 VALUES ( 1, 7, 8 );
    UPDATE T1 SET I1 = 2 WHERE I2 = 2;
    ```

  - **Actual Results**

    ```sql
    [ERR-11069 : Internal server error in the storage manager (fail to insert key)]
    ```

  - **Expected Results**

    ```sql
    1 row inserted.
    ```

-   **Workaround**

-   **Changes**

    -   Performance view
    -   Property
    -   Compile Option
    -   Error Code

### BUG-51630<a name=bug-51630></a> An error occurs when DDL is executed on a table that has inter-referencing relationships with tables, views, and functions

- **module**: qp-ddl-dcl-execute

- **Category**: Functional Error

- **Description**: Fixed an issue where the error `[ERR-01067 : The memory size allocated for the statement has exceeded the maximum limit]`  occurred when executing DDL on a table that has inter-referencing relationships with views and functions.

- **How to reproduce this bug**

  - **Reproduction conditions**

    ```sql
    CREATE TABLE t1 (c1 CHAR(32000)) TABLESPACE SYS_TBS_DISK_DATA;
    CREATE OR REPLACE FUNCTION func1 RETURN CHAR(32000)
    AS
    var1 CHAR(32000);
    BEGIN
      SELECT c1 into var1 FROM t1 limit 1;
      RETURN var1;
    END;
    /
    CREATE OR REPLACE VIEW v1 AS SELECT func1() val1 FROM t1;
    ALTER TABLE t1 ADD (c2 varchar(32000));
    ALTER TABLE t1 ADD (c3 varchar(32000));
    ```

  - **Actual Results**

    ```
    [ERR-01067 : The memory size allocated for the statement has exceeded the maximum limit ( Name : Query_Prepare, Wanted Memory Size : 209732568, Max size : 209715200 ).]
    ```

  - **Expected Results**

        Alter success.

- **Workaround**

      Before executing the DDL statement, check and compile the function to ensure the function's status is valid.

- **Changes**

  -   Performance view
  -   Property
  -   Compile Option
  -   Error Code

### BUG-51707<a name=bug-51707></a> In a multi-replication environment, an error occurs while reading the LOB log in one replication if another replication has a disk table that includes a LOB

- **module**: rp-sender
- **Category**: Functional Error
- **Description**: Fixed an error caused by incorrect handling of disk LOB transaction log metadata by replication. The processing was modified to skip metadata processing if the LOB log is not its own.

- **How to reproduce this bug**

  - **Reproduction conditions**

        1. Create a replication REP1 with T1(disk table containing LOBs)
        2. Create a replication REP2
        3. Start REP1 and REP2
        4. Executing an INSERT on the LOB table

  -   **Actual Results**

          An error occurred while processing missing metadata during the reading of T1 logs in REP2.

  -   **Expected Results**

          REP2 reads T1's logs and skips logs unrelated to itself to operate normally.

-   **Workaround**

-   **Changes**

    -   Performance view
    -   Property
    -   Compile Option
    -   Error Code

### BUG-51766<a name=bug-51766></a> Added config.xml.sample for altiMon configuration file

- **module**: ux-altiMon
- **Category**: Usability
- **Description**: Due to an issue where the user-configured `config.xml` file was being deleted from the `altiMon/conf` directory after being patched, the altiMon configuration file is now provided as `config.xml.sample`.

-   **How to reproduce this bug**
    -   **Reproduction conditions**
    
    -   **Actual Results**
    
    -   **Expected Results**
    
-   **Workaround**

-   **Changes**

    -   Performance view
    -   Property
    -   Compile Option
    -   Error Code

### BUG-51790<a name=bug-51790></a> Changed the MAX LOOP value that determines if the connection between leaf nodes is broken during memory index traversal

- **module**: sm
- **Category**: Enhancement
- **Description**: The upper limit for the number of nodes accessible during a memory index traveral has been changed from the previous 1 million to "10 times the total number of index nodes".

-   **How to reproduce this bug**
-   **Reproduction conditions**
    
-   **Actual Results**
    
-   **Expected Results**
-   **Workaround**
-   **Changes**

    -   Performance view
    -   Property
    -   Compile Option
    -   Error Code

### BUG-51804<a name=bug-51804></a> Fixed an issue where unexpected behavior could occur if the server is forcefully terminated after creating a memory table containing a VARIABLE column (before the FLUSH stage)

- **module**: sm
- **Category**: Other
- **Description**: Fixed an issue where unexpected behavior could occur if the server is forcefully terminated after creating a memory table with a `VARIABLE` column (before the FLUSH stage).

-   **How to reproduce this bug**

    -   **Reproduction conditions**

    -   **Actual Results**

    -   **Expected Results**

-   **Workaround**

-   **Changes**
    -   Performance view
    -   Property
    -   Compile Option
    -   Error Code

Changes
=======

### Version Info

| altibase version | database binary version | meta version | cm protocol version | replication protocol version |
| ---------------- | ----------------------- | ------------ | ------------------- | ---------------------------- |
| 7.1.0.10.5       | 6.5.1                   | 8.12.1       | 7.1.7               | 7.4.7                        |

> You can check the module version change history in [Version_Histories](https://github.com/ALTIBASE/Documents/blob/master/PatchNotes/Altibase_7.1/Altibase_7_1_Version_Histories.md).

### Compatibility

#### Database binary version

The database binary version has not changed.

> The database binary version indicates the compatibility of database image files and log files. If this version needs to be patched to a different version, the database must be reorganized.

#### Meta Version

The meta version has not changed.

> If you want to roll back the patch after patching to a version with a changed meta version, see [Meta Downgrade](https://github.com/ALTIBASE/Documents/blob/master/Manuals/Altibase_7.1/eng/Installation%20Guide.md#meta-downgrade).

#### CM protocol Version

The cm protocol version has not changed.

#### Replication protocol Version

The replication protocol version has not changed.

### Altibase Server Properties

No properties added/changed/deleted.

### Performance Views

No performance views added/changed/deleted.
