Altibase 7.1.0.4.4 Patch Notes
==============================

<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->


- [New Features](#new-features)
  - [BUG-47652 Added a property to control access permissions for files generated by iSQL, aexport, and iLoader.](#bug-47652%C2%A0added-a-property-to-control-access-permissions-for-files-generated-by-isql-aexport-and-iloader)
- [Fixed Bugs](#fixed-bugs)
  - [BUG-47902  Replication start may fail in SQL apply mode if the item count is the same but the table structure differs.](#bug-47902%C2%A0-replication-start-may-fail-in-sql-apply-mode-if-the-item-count-is-the-same-but-the-table-structure-differs)
  - [BUG-48066  Fixed an issue where a deadlock could occur when executing DDL with DDL SYNC set to 1 and LOCK TABLE in effect.](#bug-48066-%C2%A0fixed-an-issue-where-a-deadlock-could-occur-when-executing-ddl-with-ddl-sync-set-to-1-and-lock-table-in-effect)
  - [BUG-48069  Fixed an issue where starting replication after stopping it would fail when the table contains a GEOMETRY column.](#bug-48069%C2%A0-fixed-an-issue-where-starting-replication-after-stopping-it-would-fail-when-the-table-contains-a-geometry-column)
  - [BUG-48076 Fixed an issue where using the WITH clause on a disk table with a constant predicate combined with an OR clause resulted in incorrect query results.](#bug-48076-fixed-an-issue-where-using-the-with-clause-on-a-disk-table-with-a-constant-predicate-combined-with-an-or-clause-resulted-in-incorrect-query-results)
  - [BUG-48091 Fixed an issue where meta upgrade would fail when meta was used in a user-defined PSM (Persistent Stored Module).](#bug-48091-fixed-an-issue-where-meta-upgrade-would-fail-when-meta-was-used-in-a-user-defined-psm-persistent-stored-module)
  - [BUG-48096 Added the missing altibase_cli.ini.sample file to the package.](#bug-48096%C2%A0added-the-missing-altibase_cliinisample-file-to-the-package)
  - [BUG-48101 Fixed an issue where a result error occurred when using duplicate targets in distinct sort.](#bug-48101%C2%A0fixed-an-issue-where-a-result-error-occurred-when-using-duplicate-targets-in-distinct-sort)
  - [BUG-48116  Fixed an issue where a recursive WITH query view would cause an abnormal shutdown under certain conditions when restarted.](#bug-48116%C2%A0-fixed-an-issue-where-a-recursive-with-query-view-would-cause-an-abnormal-shutdown-under-certain-conditions-when-restarted)
  - [BUG-48119  Fixed an issue where an 'Incompatible property' error occurred when performing `is` or `iloader` operations from a 7.1.0.3.0 or higher client to a 7.1.0.2.9 or lower server.](#bug-48119%C2%A0-fixed-an-issue-where-an-incompatible-property-error-occurred-when-performing-is-or-iloader-operations-from-a-71030-or-higher-client-to-a-71029-or-lower-server)
  - [BUG-48125 Fixed an issue where a trigger caused incorrect behavior during the execution of a MERGE query. 할 수 있습니다.](#bug-48125-fixed-an-issue-where-a-trigger-caused-incorrect-behavior-during-the-execution-of-a-merge-query-%ED%95%A0-%EC%88%98-%EC%9E%88%EC%8A%B5%EB%8B%88%EB%8B%A4)
- [Changes](#changes)
  - [Version Info](#version-info)
  - [Compatibility](#compatibility)
  - [Altibase Server Properties](#altibase-server-properties)
  - [Performance Views](#performance-views)

<!-- END doctoc generated TOC please keep comment here to allow auto update -->

New Features
------------

### BUG-47652 Added a property to control access permissions for files generated by iSQL, aexport, and iLoader.

-   **module** : ux-isql
-   **Category** : Enhancement
-   **Reproducibility** : Always
-   **Description** : Added a property to control access permissions for files generated by iSQL, aexport, and iLoader.
-   **How to reproduce this bug**

    -   **Reproduction conditions**

    -   **Actual Results**

    -   **Expected Results**
-   **Workaround**
- **Changes**

  -   Performance view
  - Property
    - ALTIBASE_UT_FILE_PERMISSION
       - Description : Configure permissions for files generated by aexport, iLoader, and iSQL.
      - Default value: 666 (user:rw,  group:rw,  other: rw)
    - ISQL_FILE_PERMISSION
       - Description : ISQL_FILE_PERMISSION takes precedence over ALTIBASE_UT_FILE_PERMISSION when configuring file permissions for files generated by iSQL.
       - Default Value: 666 (user:rw,  group:rw,  other: rw)
    - AEXPORT_FILE_PERMISSION
       - Description :AEXPORT_FILE_PERMISSION takes precedence over ALTIBASE_UT_FILE_PERMISSION when configuring file permissions for files generated by aexport.
       - Default Value: 666 (user:rw,  group:rw,  other: rw)
    - ILO_FILE_PERMISSION
       - Description : ILO_FILE_PERMISSION takes precedence over ALTIBASE_UT_FILE_PERMISSION when configuring file permissions for files generated by iLoader.
       - Default Value: 666 (user:rw,  group:rw,  other: rw)
  -   Compile Option
  -   Error Code
      -   326, HY000, utERR\_ABORT\_FilePerm\_OutOfRange\_Error = File
          permission value is out of range (\<0%s\>=\<1%s\>)
          \# \*Cause: File permission value is out of range.
          \# \*Action: Use valid file permission value.

Fixed Bugs
----------

### BUG-47902  Replication start may fail in SQL apply mode if the item count is the same but the table structure differs.

-   **module** : rp

-   **Category** : Functional Error

-   **Reproducibility** : Always

-   **Description** : Fixed an issue where replication start could fail in SQL apply mode if the item count was the same but the table structure differed.
    
-   **How to reproduce this bug**

    -   **Reproduction conditions**

    -   **Actual Results**

    -   **Expected Results**

-   **Workaround**

-   **Changes**

    -   Performance view
    -   Property
    -   Compile Option
    -   Error Code

### BUG-48066  Fixed an issue where a deadlock could occur when executing DDL with DDL SYNC set to 1 and LOCK TABLE in effect.

-   **module** : rp

-   **Category** : Other

-   **Reproducibility** : Always

-   **Description** : Fixed an issue where a deadlock could occur when executing DDL with DDL SYNC set to 1 and LOCK TABLE in effect.
    
-   **How to reproduce this bug**

    -   **Reproduction conditions**

            ALTER SYSTEM SET REPLICATION_DDL_SYNC = 1;
            ALTER SESSION SET REPLICATION_DDL_SYNC = 1;   
            ALTER REPLICATION REP1 START;
            AUTOCOMMIT OFF;
            LOCK TABLE T1 IN EXCLUSIVE MODE UNTIL NEXT DDL;
            ALTER REPLICATION REP1 STOP;
            ALTER TABLE T1 SPLIT PARTITION P2 AT(20) INTO( PARTITION P3, PARTITION P4 );

    -   **Actual Results**

            hang

    -   **Expected Results**

            ALTER FAIL

-   **Workaround**

        LOCK TABLE T1 IN EXCLUSIVE MODE UNTIL NEXT DDL; 하지 않거나 REPLICATION_DDL_SYNC를 0으로 함

-   **Changes**

    -   Performance view
    -   Property
    -   Compile Option
    -   Error Code

### BUG-48069  Fixed an issue where starting replication after stopping it would fail when the table contains a GEOMETRY column.

-   **module** : rp

-   **Category** : Functional Error

-   **Reproducibility** : Always

-   **Description** : Fixed an issue where starting replication after stopping it would fail when the table contains a GEOMETRY column.
    
-   **How to reproduce this bug**

    -   **Reproduction conditions**

            CREATE TABLE T1 ( I1 INTEGER PRIMARY KEY, OBJ GEOMETRY SRID 100 );
            CREATE REPLICATION REP1 WITH ...
                   FROM SYS.T1 TO SYS.T1;
            ALTER REPLICATION REP1 START;
            ALTER REPLICATION REP1 STOP;
            ALTER REPLICATION REP1 START;

    -   **Actual Results**

            [ERR-6100D : [Sender] Failed to handshake with the peer server (The geometry SRID of the replicated table's column does not match. [T1(Name:OBJ, SRID:0):T1(Name:OBJ, SRID: 100)].)]

    -   **Expected Results**

            Alter success.

-   **Workaround**

-   **Changes**

    -   Performance view
    -   Property
    -   Compile Option
    -   Error Code

### BUG-48076 Fixed an issue where using the WITH clause on a disk table with a constant predicate combined with an OR clause resulted in incorrect query results.

-   **module** : qp

-   **Category** : Functional Error

-   **Reproducibility** : Always

-   **Description** : Fixed an issue where using the WITH clause on a disk table with a constant predicate combined with an OR clause resulted in incorrect query results.
    
-   **How to reproduce this bug**

    -   **Reproduction conditions**

            drop table MA_PLANT_MST;
            create table MA_PLANT_MST( 
            COMPANY_CD                               VARCHAR(28)                 NOT NULL,
            PLANT_CD                                 VARCHAR(28)                 NOT NULL,
            PLANT_NM                                 VARCHAR(200)                NOT NULL
            ) tablespace sys_tbs_disk_data;
            alter table MA_PLANT_MST add primary key ( COMPANY_CD, PLANT_CD );
            INSERT INTO MA_PLANT_MST (COMPANY_CD, PLANT_CD, PLANT_NM) VALUES ('1000', 'DETAIL_AUTH_NOT_USED', 'TEST');
            INSERT INTO MA_PLANT_MST (COMPANY_CD, PLANT_CD, PLANT_NM) VALUES ('1001', 'DETAIL_AUTH_NOT_USED', 'TEST');
            INSERT INTO MA_PLANT_MST (COMPANY_CD, PLANT_CD, PLANT_NM) VALUES ('1002', 'DETAIL_AUTH_NOT_USED', 'TEST');
            INSERT INTO MA_PLANT_MST (COMPANY_CD, PLANT_CD, PLANT_NM) VALUES ('1003', 'DETAIL_AUTH_NOT_USED', 'TEST');
            INSERT INTO MA_PLANT_MST (COMPANY_CD, PLANT_CD, PLANT_NM) VALUES ('1004', 'DETAIL_AUTH_NOT_USED', 'TEST');
            INSERT INTO MA_PLANT_MST (COMPANY_CD, PLANT_CD, PLANT_NM) VALUES ('1005', 'DETAIL_AUTH_NOT_USED', 'TEST');
            INSERT INTO MA_PLANT_MST (COMPANY_CD, PLANT_CD, PLANT_NM) VALUES ('1006', 'DETAIL_AUTH_NOT_USED', 'TEST');
            INSERT INTO MA_PLANT_MST (COMPANY_CD, PLANT_CD, PLANT_NM) VALUES ('1007', 'DETAIL_AUTH_NOT_USED', 'TEST');
            INSERT INTO MA_PLANT_MST (COMPANY_CD, PLANT_CD, PLANT_NM) VALUES ('1008', 'DETAIL_AUTH_NOT_USED', 'TEST');
            INSERT INTO MA_PLANT_MST (COMPANY_CD, PLANT_CD, PLANT_NM) VALUES ('1009', 'DETAIL_AUTH_NOT_USED', 'TEST');
            INSERT INTO MA_PLANT_MST (COMPANY_CD, PLANT_CD, PLANT_NM) VALUES ('1010', 'DETAIL_AUTH_NOT_USED', 'TEST');
            INSERT INTO MA_PLANT_MST (COMPANY_CD, PLANT_CD, PLANT_NM) VALUES ('1011', 'DETAIL_AUTH_NOT_USED', 'TEST');
            INSERT INTO MA_PLANT_MST (COMPANY_CD, PLANT_CD, PLANT_NM) VALUES ('1012', 'DETAIL_AUTH_NOT_USED', 'TEST');
            INSERT INTO MA_PLANT_MST (COMPANY_CD, PLANT_CD, PLANT_NM) VALUES ('1013', 'DETAIL_AUTH_NOT_USED', 'TEST');
            INSERT INTO MA_PLANT_MST (COMPANY_CD, PLANT_CD, PLANT_NM) VALUES ('KC_TEST', 'DETAIL_AUTH_NOT_USED1', 'TEST');
            INSERT INTO MA_PLANT_MST (COMPANY_CD, PLANT_CD, PLANT_NM) VALUES ('KC_TEST', 'DETAIL_AUTH_NOT_USED2', 'TEST');
            INSERT INTO MA_PLANT_MST (COMPANY_CD, PLANT_CD, PLANT_NM) VALUES ('KC_TEST', 'DETAIL_AUTH_NOT_USED3', 'TEST');
            INSERT INTO MA_PLANT_MST (COMPANY_CD, PLANT_CD, PLANT_NM) VALUES ('KC_TEST', 'DETAIL_AUTH_NOT_USED4', 'TEST');
            INSERT INTO MA_PLANT_MST (COMPANY_CD, PLANT_CD, PLANT_NM) VALUES ('KC_TEST', 'DETAIL_AUTH_NOT_USED5', 'TEST');
            INSERT INTO MA_PLANT_MST (COMPANY_CD, PLANT_CD, PLANT_NM) VALUES ('KC_TEST', 'DETAIL_AUTH_NOT_USED6', 'TEST');
            CREATE OR REPLACE FUNCTION upper_function(p1 IN VARCHAR)
            RETURN VARCHAR
            AS
            BEGIN
              RETURN UPPER(p1);
            END;
            /
            PREPARE
            WITH MPM_W AS
            (
            SELECT  *
                            FROM    MA_PLANT_MST MPM
                            WHERE COMPANY_CD = 'KC_TEST'
            )
            SELECT /*+ */ * FROM MPM_W WHERE MPM_W.PLANT_CD IN
                             (
                                    'test'
                             ) OR upper_function(lower('KC_TEST')) = 'KC_TEST';

    -   **Actual Results**

            No rows selected.

    -   **Expected Results**

            KC_TEST                       DETAIL_AUTH_NOT_USED1TEST                                                                                                                                                                                               KC_TEST                       DETAIL_AUTH_NOT_USED2TEST                                                                                                                                                                                               KC_TEST                       DETAIL_AUTH_NOT_USED3TEST                                                                                                                                                                                               KC_TEST                       DETAIL_AUTH_NOT_USED4TEST                                                                                                                                                                                               KC_TEST                       DETAIL_AUTH_NOT_USED5TEST                                                                                                                                                                                               KC_TEST                       DETAIL_AUTH_NOT_USED6TEST                                                                                                                                                                                               6 rows selected.

-   **Workaround**

        CREATE INDEX MPM_I2 ON MA_PLANT_MST( COMPANY_CD );
        PREPARE
        WITH MPM_W AS
        (
        SELECT  *
                        FROM    MA_PLANT_MST MPM
                        WHERE COMPANY_CD = 'KC_TEST'
        )
        SELECT /*+ INDEX(MPM_W, MPM_I2) */ * FROM MPM_W WHERE MPM_W.PLANT_CD IN
                         (
                                'test'
                         ) OR upper_function(lower('KC_TEST')) = 'KC_TEST';
    
-   **Changes**

    -   Performance view
    -   Property
    -   Compile Option
    -   Error Code

### BUG-48091 Fixed an issue where meta upgrade would fail when meta was used in a user-defined PSM (Persistent Stored Module).

-   **module** : qp-meta

-   **Category** : Functional Error

-   **Reproducibility** : Always

-   **Description** : Fixed an issue where meta upgrade would fail when meta was used in a user-defined PSM (Persistent Stored Module).
    
-   **How to reproduce this bug**

    -   **Reproduction conditions**

    -   **Actual Results**
    
    -   **Expected Results**
    
-   **Workaround**

-   **Changes**

    -   Performance view
    -   Property
    -   Compile Option
    -   Error Code

### BUG-48096 Added the missing altibase_cli.ini.sample file to the package.

-   **module** : pkg-map

-   **Category** : Usability

-   **Reproducibility** : Always

-   **Description** : Added the missing altibase_cli.ini.sample file to the package.
    
-   **How to reproduce this bug**

    -   **Reproduction conditions**

    -   **Actual Results**

    -   **Expected Results**

-   **Workaround**

-   **Changes**

    -   Performance view
    -   Property
    -   Compile Option
    -   Error Code

### BUG-48101 Fixed an issue where a result error occurred when using duplicate targets in distinct sort.

-   **module** : qp-select-pvo

-   **Category** : Functional Error

-   **Reproducibility** : Always

-   **Description** : Fixed an issue where a result error occurred when using duplicate targets in distinct sort.
    
- **How to reproduce this bug**

  -   **Reproduction conditions**

          drop table t1;
          create table t1 (i1 varchar(11), i2 int);
          insert into t1 values( '20000230712', 179820);
          insert into t1 values( '20000230714', 227810);
          insert into t1 values( '20000230718', 460280);
          select /*+ distinct_sort*/
               distinct 
                  a.i1
                , 1* a.i2
                , 1 * b.c2
                , a.i2 - b.c2 a1
                , a.i2 - b.c2 a2
          from ( select /*+ no_merge*/ i1, i2 from t1 ) a 
             left outer join 
               ( select i1, (i2 * 0) as c2 from t1 ) b
             on b.i1 = a.i1;

  - **Actual Results**

        I1           1*A.I2                 1*B.C2                 A1                     A2
        ---------------------------------------------------------------------------------------------------------------
        20000230712  179820                 0                      460280                 460280
        20000230714  227810                 0                      460280                 460280
        20000230718  460280                 0                      460280                 460280
        3 rows selected.

  -   **Expected Results**

          I1           1*A.I2                 1*B.C2                 A1                     A2
          ---------------------------------------------------------------------------------------------------------------
          20000230712  179820                 0                      179820                 179820
          20000230714  227810                 0                      227810                 227810
          20000230718  460280                 0                      460280                 460280
          3 rows selected.

-   **Workaround**

        distinct_hash

-   **Changes**

    -   Performance view
    -   Property
    -   Compile Option
    -   Error Code

### BUG-48116  Fixed an issue where a recursive WITH query view would cause an abnormal shutdown under certain conditions when restarted.

-   **module** : qp-dml-execute

-   **Category** : Fatal

-   **Reproducibility** : Always

-   **Description** : Fixed an issue where a recursive WITH query view would cause an abnormal shutdown under certain conditions when restarted.
    
- **How to reproduce this bug**

  -   **Reproduction conditions**

          drop table t1;
          create table t1 ( COMPANY_CD varchar(28), PCA_GRP_CD varchar(80) );
          insert into t1 values ( '1000', '22000' );
          insert into t1 values ( '1000', '23000' );
          insert into t1 values ( '1000', '24000' );
          insert into t1 values ( '1000', '25000' );
          drop table t2;
          create table t2 ( COMPANY_CD varchar(28), PCA_GRP_CD varchar(80), PCA_CD VARCHAR(80) VARIABLE);
          insert into t2 values ( '1000', '24000', '24507');
          insert into t2 values ( '1000', '25000', '25509' );
          insert into t2 values ( '1000', '25000', '25500' );
          drop table t3;
          create table t3 ( COMPANY_CD varchar(28), PCA_GRP_CD varchar(80), ACCT_CD VARCHAR(80) VARIABLE, i1 int );
          insert into t3 values ( '1000', '25000', '10112030', 1 );
          drop table t4;
          create table t4 ( COMPANY_CD varchar(28), PCA_GRP_CD varchar(80) );
          insert into t4 values ( '1000', '22000' );
          insert into t4 values ( '1000', '23000' );
          drop table t5;
          create table t5 ( COMPANY_CD varchar(28), PC_CD varchar(80), DOCU_NO VARCHAR(80) VARIABLE, ACCT_CD VARCHAR(80) VARIABLE, i1 int );
          insert into t5 values ( '1000', '1000', 'FIA202008030009', '14410010', 1 );
          insert into t5 values ( '1000', '2000', 'FI203006300003', '10112030', 1 );
          drop table t6;
          create table t6 ( COMPANY_CD varchar(28), PC_CD varchar(80), DOCU_NO VARCHAR(80) VARIABLE, MNGD_CD VARCHAR(80) VARIABLE, i1 int );
          insert into t6 values ( '1000', '2000', 'FI203006300003', '25500', 1 );
          WITH T_MA_PCAGRP_MST( COMPANY_CD, PCA_GRP_CD, ROOT_PCA_GRP_CD ) AS (
                      SELECT COMPANY_CD, PCA_GRP_CD, PCA_GRP_CD AS ROOT_PCA_GRP_CD
                      FROM   t1
                      WHERE  COMPANY_CD = '1000'
                      UNION ALL
                      SELECT MPM.COMPANY_CD, MPM.PCA_GRP_CD, T_MPM.ROOT_PCA_GRP_CD
                      FROM   t1 MPM
                             INNER JOIN T_MA_PCAGRP_MST T_MPM
                             ON  MPM.COMPANY_CD = T_MPM.COMPANY_CD
                             AND MPM.PCA_GRP_CD = T_MPM.PCA_GRP_CD
                      WHERE  MPM.COMPANY_CD = '1000'
                  ),
              T_MA_PCAGRP_DTL AS (
                      SELECT MPD.PCA_CD, MPD.COMPANY_CD, T_MPM.ROOT_PCA_GRP_CD
                      FROM   t2 MPD
                             INNER JOIN T_MA_PCAGRP_MST T_MPM
                             ON  MPD.COMPANY_CD = T_MPM.COMPANY_CD
                             AND MPD.PCA_GRP_CD = T_MPM.PCA_GRP_CD
                      WHERE  MPD.COMPANY_CD = '1000'
                  )
             SELECT A.COMPANY_CD 
                    FROM t3 A
                         INNER JOIN t4 C ON C.COMPANY_CD = A.COMPANY_CD 
                         INNER JOIN t5 B ON C.COMPANY_CD = B.COMPANY_CD 
                         INNER JOIN t6 E ON E.COMPANY_CD = B.COMPANY_CD AND E.PC_CD = B.PC_CD AND E.DOCU_NO = B.DOCU_NO 
                         LEFT OUTER JOIN t3 H ON 
                            A.COMPANY_CD = H.COMPANY_CD 
                            AND H.PCA_GRP_CD IN ( SELECT /*+  */ ROOT_PCA_GRP_CD FROM T_MA_PCAGRP_DTL WHERE  PCA_CD = E.MNGD_CD   )
                            AND H.ACCT_CD = B.ACCT_CD;

  -   **Actual Results**

          [ERR-91015 : Communication failure.]

  -   **Expected Results**

          COMPANY_CD
          --------------------------------
          1000
          1000
          2 rows selected.

-   **Workaround**

-   **Changes**

    -   Performance view
    -   Property
    -   Compile Option
    -   Error Code

### BUG-48119  Fixed an issue where an 'Incompatible property' error occurred when performing `is` or `iloader` operations from a 7.1.0.3.0 or higher client to a 7.1.0.2.9 or lower server.

-   **module** : rp

-   **Category** : Functional Error

-   **Reproducibility** : Always

-   **Description** : Fixed an issue where the 'GLOBAL_TRANSACTION_LEVEL' property (formerly 'DBLINK_GLOBAL_TRANSACTION_LEVEL') caused an 'ERR-5108B : Incompatible property' error when performing `is` or `iloader` operations from a 7.1.0.3.0 or higher client to a 7.1.0.2.9 or lower server. This property, which is used only in ShardCLI, will no longer be checked during ALTIBASE CLI connections.
    
-   **How to reproduce this bug**
-   **Reproduction conditions**
    
-   **Actual Results**
    
-   **Expected Results**
    
-   **Workaround**

-   **Changes**
-   Performance view
    -   Property
    -   Compile Option
    -   Error Code

### BUG-48125 Fixed an issue where a trigger caused incorrect behavior during the execution of a MERGE query. 할 수 있습니다.

-   **module** : qp-psm-trigger-execute

-   **Category** : Fatal

-   **Reproducibility** : Rare

-   **Description** : Fixed an issue where a trigger caused incorrect behavior during the execution of a MERGE query.
    
-   **How to reproduce this bug**

    -   **Reproduction conditions**

            drop table t1;
            create table t1 (
            SVC_CONT_ID                              VARCHAR(20)     FIXED ,
            EFCT_ST_DT                               DATE            FIXED ,
            EFCT_FNS_DT                              DATE            FIXED ,
            APLY_BILL_TGT_YM                         varchar(20)
            );
            insert into t1 values( 'S2030835670',           to_date('30-JUN-2020'),  to_date('31-DEC-9999'),  '202006');
            insert into t1 values( 'S2030860590',           to_date('30-JUN-2020'),  to_date('31-DEC-9999'),  '202006');
            insert into t1 values( 'S2030837090',           to_date('10-JUN-2020'),  to_date('31-DEC-9999'),  '202006');
            insert into t1 values( 'S2030837070',           to_date('20-JUN-2020'),  to_date('31-DEC-9999'),  '202006');
            insert into t1 values( 'S2030843010',           to_date('23-JUN-2020'),  to_date('31-DEC-9999'),  '202006');
            insert into t1 values( 'S2030849390',           to_date('19-JUN-2020'),  to_date('31-DEC-9999'),  '202006');
            insert into t1 values( 'S2030860630',           to_date('29-JUN-2020'),  to_date('31-DEC-9999'),  '202006');
            insert into t1 values( 'S0000407100',           to_date('26-JUN-2020'),  to_date('31-DEC-9999'),  '202006');
            insert into t1 values( 'S0000263580',           to_date('04-JUN-2020'),  to_date('31-DEC-9999'),  '202006');
            insert into t1 values( 'S2030848490',           to_date('24-JUN-2020'),  to_date('31-DEC-9999'),  '202006');
            insert into t1 values( 'S2030858690',           to_date('30-JUN-2020'),  to_date('31-DEC-9999'),  '202006');
            insert into t1 values( 'S2030837610',           to_date('22-JUN-2020'),  to_date('31-DEC-9999'),  '202006');
            insert into t1 values( 'S0000327500',           to_date('04-JUN-2020'),  to_date('31-DEC-9999'),  '202006');
            insert into t1 values( 'S2030849550',           to_date('04-JUN-2020'),  to_date('31-DEC-9999'),  '202006');
            insert into t1 values( 'S2030836150',           to_date('23-JUN-2020'),  to_date('31-DEC-9999'),  '202006');
            insert into t1 values( 'S2030837530',           to_date('27-JUN-2020'),  to_date('31-DEC-9999'),  '202006');
            insert into t1 select level, sysdate, sysdate, level from dual connect by level < 90000;
            drop table t2;
            create table t2 (
                 SVC_CONT_ID                              VARCHAR(20)     FIXED ,
                 SVC_CONT_SBSC_DT                         DATE            FIXED,
                  BM_CTG_CD                                VARCHAR(20)     FIXED ,
                  LAST_SVC_CONT_STTUS_CD                   VARCHAR(3)      FIXED 
            );
            insert into t2 values( 'S2030858690',           to_date('01-JAN-2020'),  '928001', 'C');
            insert into t2 values( 'S0000263580',           to_date('02-OCT-2018'),  '928001', 'C');
            insert into t2 values( 'S0000327500',           to_date('03-NOV-2018'),  '928001', 'C');
            insert into t2 values( 'S2030849550',           to_date('05-APR-2020'),  '928001', 'C');
            insert into t2 values( 'S2030848490',           to_date('28-MAY-2020'),  '928001', 'C');
            insert into t2 values( 'S2030837530',           to_date('17-APR-2020'),  '928001', 'C');
            insert into t2 values( 'S2030835670',           to_date('13-APR-2020'),  '928001', 'C');
            insert into t2 values( 'S2030837610',           to_date('17-MAR-2020'),  '928001', 'C');
            insert into t2 values( 'S2030837090',           to_date('13-APR-2020'),  '928001', 'C');
            insert into t2 values( 'S2030837070',           to_date('05-FEB-2020'),  '928001', 'C');
            insert into t2 values( 'S2030836150',           to_date('14-APR-2020'),  '928001', 'C');
            insert into t2 values( 'S2030843010',           to_date('15-MAY-2020'),  '928001', 'C');
            insert into t2 values( 'S2030849390',           to_date('30-MAY-2020'),  '928001', 'C');
            insert into t2 values( 'S2030860590',           to_date('26-JUN-2020'),  '928001', 'C');
            insert into t2 values( 'S2030860630',           to_date('26-JUN-2020'),  '928001', 'C');
            insert into t2 values( 'S0000407100',           to_date('19-JUL-2018'),  '928001', 'C');
            insert into t2 select level, sysdate, level, 'X' from dual connect by level < 70000;
            drop table t3;
            create table t3 (
                 SVC_CONT_ID                              VARCHAR(20)     FIXED,
                 PROD_ID                                  VARCHAR(20)     FIXED 
            );
            insert into t3 values('S0000263580','P00100001');
            insert into t3 values('S2030849550','P00100161');
            insert into t3 values('S0000327500','P00100001');
            insert into t3 values('S2030837530','P00100001');
            insert into t3 values('S2030837610','P00100046');
            insert into t3 values('S2030836150','P00100158');
            insert into t3 values('S2030835670','P00100158');
            insert into t3 values('S2030837530','P00100046');
            insert into t3 values('S2030837070','P00100158');
            insert into t3 values('S2030837090','P00100158');
            insert into t3 values('S2030848490','P00100164');
            insert into t3 values('S2030858690','P00100161');
            insert into t3 values('S2030837070','P00100164');
            insert into t3 values('S2030843010','P00100046');
            insert into t3 values('S2030860630','P00100161');
            insert into t3 values('S2030849550','P00100158');
            insert into t3 values('S2030849390','P00100161');
            insert into t3 values('S2030860590','P00100161');
            insert into t3 values('S0000407100','P00100001');
            insert into t3 values('S2030843010','P00100001');
            insert into t3  select level, level from dual connect by level < 110000;
            drop trigger trig1;
            create or replace trigger trig1
            after UPDATE
            on t1
            REFERENCING NEW AS NEW_ROW OLD AS OLD_ROW
            FOR EACH ROW
            AS
            SVC_CONT_ID     VARCHAR(20);
            BEGIN    
                SVC_CONT_ID := 'XX';
                insert into t3  values ( SVC_CONT_ID, NULL );
            END;
            /
            drop trigger trig2;
            create or replace trigger trig2
            after UPDATE
            on t1
            REFERENCING NEW AS NEW_ROW OLD AS OLD_ROW
            FOR EACH ROW
            AS
            SVC_CONT_ID     VARCHAR(20);
            BEGIN    
                SVC_CONT_ID := 'XX';
                insert into t2 (SVC_CONT_ID) values ( SVC_CONT_ID );
            END;
            /
             MERGE INTO t1 A
                USING (
                        SELECT B.* FROM t2 B
                        JOIN t3 C ON B.SVC_CONT_ID = C.SVC_CONT_ID AND C.PROD_ID LIKE 'P%'
                            AND PROD_ID != 'P00100165'
                        WHERE B.SVC_CONT_SBSC_DT IS NOT NULL AND B.BM_CTG_CD = '928001'
                    ) B  ON (A.SVC_CONT_ID = B.SVC_CONT_ID AND B.LAST_SVC_CONT_STTUS_CD = 'C'
                    AND A.EFCT_ST_DT BETWEEN TO_DATE('202006', 'YYYYMM') AND LAST_DAY(TO_DATE('202006', 'YYYYMM'))+0.99999
                     AND A.EFCT_ST_DT - B.SVC_CONT_SBSC_DT > 1
                     )
                 WHEN MATCHED THEN
                 UPDATE SET A.APLY_BILL_TGT_YM = '202006';

    -   **Actual Results**

    -   **Expected Results**
    
            20 rows merged.
    
-   **Workaround**

-   **Changes**

    -   Performance view
    -   Property
    -   Compile Option
    -   Error Code

Changes
-------

### Version Info

| altibase version | database binary version | meta version | cm protocol version | replication protocol version |
| ---------------- | ----------------------- | ------------ | ------------------- | ---------------------------- |
| 7.1.0.4.4        | 6.5.1                   | 8.9.1        | 7.1.7               | 7.4.6                        |

> You can check the module version change history in [Version_Histories](https://github.com/ALTIBASE/Documents/blob/master/PatchNotes/Altibase_7.1/Altibase_7_1_Version_Histories.md).

### Compatibility

#### Database binary version

The database binary version has not changed.

> The database binary version indicates the compatibility of database image files and log files. If this version needs to be patched to a different version, the database must be reorganized.

#### Meta Version

The meta version has not changed.

> If you want to roll back the patch after patching to a version with a changed meta version, see [Meta Downgrade](https://github.com/ALTIBASE/Documents/blob/master/Manuals/Altibase_7.1/eng/Installation Guide.md#meta-downgrade).

#### CM protocol Version

The cm protocol version has not changed.

#### Replication protocol Version

The replication protocol version has not changed.

### Altibase Server Properties

#### Added properties

* [ALTIBASE_UT_FILE_PERMISSION](https://github.com/ALTIBASE/Documents/blob/master/Manuals/Altibase_7.1/kor/iSQL.md#altibase_ut_file_permission)
* [ISQL_FILE_PERMISSION](https://github.com/ALTIBASE/Documents/blob/master/Manuals/Altibase_7.1/kor/iSQL.md#isql_file_permission)
* [AEXPORT_FILE_PERMISSION](https://github.com/ALTIBASE/Documents/blob/master/Manuals/Altibase_7.1/kor/Utilities.md#aexport_file_permission)
* [ILO_FILE_PERMISSION](https://github.com/ALTIBASE/Documents/blob/master/Manuals/Altibase_7.1/kor/iLoader.md#ilo_file_permission)

### Performance Views

No performance views were added, modified, or deleted.
